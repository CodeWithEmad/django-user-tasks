{
    "definitions": {
        "Artifact": {
            "type": "object",
            "properties": {
                "created": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Creation time of the artifact"
                },
                "file": {
                    "type": "string",
                    "format": "url",
                    "description": "URL of a file containing artifact output"
                },
                "modified": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Last modified time of the artifact"
                },
                "name": {
                    "type": "string",
                    "description": "A name for this artifact to distinguish it from others for the same task"
                },
                "status": {
                    "type": "string",
                    "format": "url",
                    "description": "URL of status information for the task which created this artifact"
                },
                "text": {
                    "type": "string",
                    "description": "Text content of the artifact"
                },
                "url": {
                    "type": "string",
                    "format": "url",
                    "description": "URL where the artifact can be viewed"
                }
            },
            "example": {
                "application/json": {
                    "status": "http://testserver/tasks/93ff16a6-77b1-435a-8774-7f695ad4ed6b/",
                    "name": "Output",
                    "created": "2016-09-16T17:13:34.036247Z",
                    "modified": "2016-09-16T17:14:07.071553Z",
                    "file": "https://www.example.com/media/user_tasks/2016/09/06/data_structures_101.zip",
                    "text": "",
                    "url": ""
                }
            }
        },
        "ArtifactList": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/Artifact"
            },
            "example": [
                {
                    "status": "http://testserver/tasks/93ff16a6-77b1-435a-8774-7f695ad4ed6b/",
                    "name": "Output",
                    "created": "2016-09-16T17:13:34.036247Z",
                    "modified": "2016-09-16T17:14:07.071553Z",
                    "file": "https://www.example.com/media/user_tasks/2016/09/06/data_structures_101.zip",
                    "text": "",
                    "url": ""
                },
                {
                    "status": "http://testserver/tasks/23f63bd5-f77a-4ce2-9b37-2d3fa913af30/",
                    "name": "Error",
                    "created": "2016-09-16T18:09:01.492088Z",
                    "modified": "2016-09-16T18:09:27.023175Z",
                    "file": "",
                    "text": "The video for Chapter 5, Section 3 could not be accessed: http://www.example.com/no_such_file.mp4",
                    "url": ""
                }
            ]
        },
        "Task": {
            "type": "object",
            "properties": {
                "artifacts": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "format": "url"
                    },
                    "description": "Array of URLs for artifacts generated by the task"
                },
                "attempts": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "How many times has execution been attempted?"
                },
                "completed_steps": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "Number of task execution stages which have already finished"
                },
                "created": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Creation time of the task status record"
                },
                "modified": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Last modified time of the task status record"
                },
                "name": {
                    "type": "string",
                    "description": "A name for this task which the triggering user will understand"
                },
                "state": {
                    "type": "string",
                    "description": "English name of the state the task is currently in"
                },
                "state_text": {
                    "type": "string",
                    "description": "Name in the user's language of the state the task is currently in"
                },
                "total_steps": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Total number of execution stages needed to complete the task"
                }
            },
            "example": {
                "name": "Export of course 'Data Structures 101'",
                "state": "Succeeded",
                "state_text": "成功しました",
                "completed_steps": 4,
                "total_steps": 4,
                "attempts": 1,
                "created": "2016-09-16T17:13:34.036247Z",
                "modified": "2016-09-16T17:13:56.123456Z",
                "artifacts": [
                    "https://www.example.com/artifacts/ef48901f-2277-4b51-9589-9e834277b23c/"
                ]
            }
        },
        "TaskList": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/Task"
            },
            "example": [
                {
                    "name": "Export of course 'Data Structures 101'",
                    "state": "In Progress",
                    "state_text": "実行中",
                    "completed_steps": 1,
                    "total_steps": 4,
                    "attempts": 1,
                    "created": "2016-09-16T17:13:34.036247Z",
                    "modified": "2016-09-16T17:13:56.123456Z",
                    "artifacts": []
                },
                {
                    "name": "Import of course 'Error Handling 102'",
                    "state": "Failed",
                    "state_text": "失敗しました",
                    "completed_steps": 2,
                    "total_steps": 4,
                    "attempts": 1,
                    "created": "2016-09-16T18:22:45.431112Z",
                    "modified": "2016-09-16T18:23:04.697064Z",
                    "artifacts": [
                        "https://www.example.com/artifacts/4b357bb3-2a1e-441d-9f6c-2210cf76606f/"
                    ]
                }
            ]
        }
    },
    "info": {
        "title": "django-user-tasks REST API",
        "version": "1.0"
    },
    "paths": {
        "/artifacts/": {
            "get": {
                "summary": "List the generated task artifacts which are accessible to the requesting user.",
                "parameters": [
                    {
                        "description": "The page number of the resulting artifact list to retrieve.",
                        "in": "query",
                        "name": "page",
                        "required": false,
                        "type": "integer",
                        "default": 1,
                        "minimum": 1
                    }
                ],
                "responses": {
                    "200": {
                        "description": "A list of task artifacts.",
                        "schema": {
                            "$ref": "#/definitions/ArtifactList"
                        }
                    },
                    "403": {
                        "description": "The requesting user lacks permission to view any task artifacts."
                    }
                },
                "tags": [
                    "artifacts"
                ]
            }
        },
        "/artifacts/{uuid}/": {
            "get": {
                "summary": "Get information about the specified task artifact.",
                "parameters": [
                    {
                        "description": "The external ID of a task artifact.",
                        "in": "path",
                        "name": "uuid",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Information about a task artifact.",
                        "schema": {
                            "$ref": "#/definitions/Artifact"
                        }
                    },
                    "404": {
                        "description": "There is no such task artifact (or the user lacks permission to view it)."
                    }
                },
                "tags": [
                    "artifacts"
                ]
            }
        },
        "/tasks/": {
            "get": {
                "summary": "List the status of user-triggered tasks which are accessible to the requesting user.",
                "parameters": [
                    {
                        "description": "The page number of the resulting task status list to retrieve.",
                        "in": "query",
                        "name": "page",
                        "required": false,
                        "type": "integer",
                        "default": 1,
                        "minimum": 1
                    }
                ],
                "responses": {
                    "200": {
                        "description": "A list of task status records.",
                        "schema": {
                            "$ref": "#/definitions/TaskList"
                        }
                    },
                    "403": {
                        "description": "The requesting user lacks permission to view any task status records."
                    }
                },
                "tags": [
                    "tasks"
                ]
            }
        },
        "/tasks/{uuid}/": {
            "delete": {
                "summary": "Delete the specified task status record and any associated artifacts.",
                "parameters": [
                    {
                        "description": "The external ID of a task status record.",
                        "in": "path",
                        "name": "uuid",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Confirmation that the task was successfully deleted."
                    },
                    "403": {
                        "description": "The user is allowed to view this status record, but lacks permission to delete it."
                    },
                    "404": {
                        "description": "There is no such task status record (or the user lacks permission to view it)."
                    }
                },
                "tags": [
                    "tasks"
                ]
            },
            "get": {
                "summary": "Get information about the specified task status record.",
                "parameters": [
                    {
                        "description": "The external ID of a task status record.",
                        "in": "path",
                        "name": "uuid",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Information about the status of a user-triggered task.",
                        "schema": {
                            "$ref": "#/definitions/Task"
                        }
                    },
                    "404": {
                        "description": "There is no such task status record (or the user lacks permission to view it)."
                    }
                },
                "tags": [
                    "tasks"
                ]
            }
        },
        "/tasks/{uuid}/cancel/": {
            "post": {
                "summary": "Cancel the task associated with the specified status record.",
                "description": "Revoke the task if it has not yet been started, instruct it to halt at the next convenient stopping point if already running, or do nothing if it has already stopped running.",
                "parameters": [
                    {
                        "description": "The external ID of a task status record.",
                        "in": "path",
                        "name": "uuid",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Confirmation that cancellation of the task is being processed."
                    },
                    "403": {
                        "description": "The user is allowed to view this status record, but lacks permission to cancel it."
                    },
                    "404": {
                        "description": "There is no such task status record (or the user lacks permission to view it)."
                    }
                },
                "tags": [
                    "tasks"
                ]
            }
        }
    },
    "produces": ["application/json"],
    "schemes": ["https"],
    "swagger": "2.0"
}
